<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0EYR0L3Y0T"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0EYR0L3Y0T');
    </script>
    <title>Pago Exitoso - Parfum</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; text-align: center; }
        .card { background: rgba(30, 41, 59, 0.7); padding: 40px; border-radius: 20px; border: 1px solid rgba(251, 191, 36, 0.3); }
    </style>
</head>
<body>
    <div class="card">
        <h1 class="text-4xl text-green-400 font-bold mb-4">Â¡Pago Exitoso! ðŸŽ‰</h1>
        <p class="text-gray-300 mb-8">Gracias por tu compra. Estamos procesando tu pedido.</p>
        <a href="/" class="bg-yellow-500 text-black px-6 py-3 rounded-full font-bold hover:bg-yellow-400 transition">Volver a la Tienda</a>
    </div>
    <script>
        window.onload = async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const orderId = urlParams.get('orderId');
            const savedUser = localStorage.getItem('parfum_user');
            if (savedUser && orderId) {
                const user = JSON.parse(savedUser);
                gtag('event', 'purchase', {
                    transaction_id: orderId,
                    value: 0.00,
                    currency: 'MXN'
                });
                try {
                    await fetch('/api/order/success', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ orderId, userId: user.id })
                    });
                } catch (e) {
                    console.error(e);
                }
            }
        };
    </script>
</body>
</html>